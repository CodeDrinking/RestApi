let CustomErrorHandler,jwtService;_dd3‍.x([["default",()=>_dd3‍.o]]);_dd3‍.w("../Services/CustomErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);_dd3‍.w("../Services/jwtService",[["default",["jwtService"],function(v){jwtService=v}]]);


const auth = async (req, res , next) =>{
    let authHeader = req.headers.authorization
    _dd3‍.g.console.log(authHeader);

    if(!authHeader){
        return next(CustomErrorHandler.unAuthorized());

    }
    const token = authHeader.split(' ')[1];
    _dd3‍.g.console.log(token);
    
    try{
        const {_id , role} = await jwtService.verify(token)
        req.user= {};
        req.user._id= _id;
        req.user.role =role;

        next();
    }
    catch(err){

    }
}

_dd3‍.d(auth);